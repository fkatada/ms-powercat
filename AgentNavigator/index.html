<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Microsoft Agent Platform Decision Tool</title>
        <meta
            name="description"
            content="Interactive tool to help you choose the best Microsoft agent platform for your use case - Microsoft 365 Copilot, Copilot Studio Lite, Copilot Studio, or Azure AI Foundry."
        />

        <!-- RTF export for Word document compatibility -->
        <link rel="stylesheet" href="../assets/css/agent-navigator.css" />
    </head>
    <body>
        <!-- Header -->
        <header class="header">
            <div class="container">
                <div class="header-content">
                    <div class="logo">
                        <div class="logo-icon">M</div>
                        <h1 class="logo-text">Agent Platform Decision Tool</h1>
                    </div>
                    <button
                        class="btn btn-ghost"
                        id="theme-toggle"
                        data-testid="button-theme-toggle"
                    >
                        <span class="icon icon-sun" id="theme-icon"></span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <!-- Progress Indicator -->
                <div class="progress-indicator">
                    <div class="progress-steps">
                        <div class="progress-step">
                            <div
                                class="step-circle pending"
                                data-step="0"
                                data-testid="step-indicator-1"
                            >
                                1
                            </div>
                            <span class="step-label">Assessment</span>
                        </div>
                        <div class="step-connector"></div>
                        <div class="progress-step">
                            <div
                                class="step-circle pending"
                                data-step="1"
                                data-testid="step-indicator-2"
                            >
                                2
                            </div>
                            <span class="step-label">Recommendation</span>
                        </div>
                        <div class="step-connector"></div>
                        <div class="progress-step">
                            <div
                                class="step-circle pending"
                                data-step="2"
                                data-testid="step-indicator-3"
                            >
                                3
                            </div>
                            <span class="step-label">Implementation</span>
                        </div>
                        <div class="step-connector"></div>
                        <div class="progress-step">
                            <div
                                class="step-circle pending"
                                data-step="3"
                                data-testid="step-indicator-4"
                            >
                                4
                            </div>
                            <span class="step-label">Structure</span>
                        </div>
                    </div>
                </div>

                <!-- Content Sections -->

                <!-- Welcome Section -->
                <div id="welcome-section" class="fade-in">
                    <div class="card">
                        <div class="card-content">
                            <div class="welcome-section">
                                <div class="welcome-icon"></div>
                                <h2 class="welcome-title">
                                    Choose Your Microsoft Agent Platform
                                </h2>
                                <p class="welcome-subtitle">
                                    Answer a few questions to discover which
                                    Microsoft agent platform best fits your
                                    scenario and requirements.
                                </p>

                                <div class="platform-grid">
                                    <div class="platform-preview">
                                        <div class="platform-preview-icon">
                                            ü§ù
                                        </div>
                                        <h3 class="platform-preview-title">
                                            Microsoft 365 Copilot
                                        </h3>
                                        <p class="platform-preview-desc">
                                            Built-in productivity assistant across Microsoft 365 apps and ready-to-use agents for specific tasks
                                        </p>
                                    </div>
                                    <div class="platform-preview">
                                        <div class="platform-preview-icon">
                                            üèóÔ∏è
                                        </div>
                                        <h3 class="platform-preview-title">
                                            Copilot Studio Agent Builder
                                        </h3>
                                        <p class="platform-preview-desc">
                                            Extend Microsoft 365 Copilot with your organization's specific knowledge and automations.
                                        </p>
                                    </div>
                                    <div class="platform-preview">
                                        <div class="platform-preview-icon">
                                            üé®
                                        </div>
                                        <h3 class="platform-preview-title">
                                            Copilot Studio
                                        </h3>
                                        <p class="platform-preview-desc">
                                            Build custom conversational and autonomous agents with workflows, process automation, integrations, and business logic.
                                        </p>
                                    </div>
                                    <div class="platform-preview">
                                        <div class="platform-preview-icon">
                                            ‚òÅÔ∏è
                                        </div>
                                        <h3 class="platform-preview-title">
                                            Azure AI Foundry
                                        </h3>
                                        <p class="platform-preview-desc">
                                            Full-stack AI development platform for custom solutions and model training.
                                        </p>
                                    </div>
                                </div>

                                <div class="center">
                                    <button
                                        class="btn btn-primary btn-lg"
                                        id="start-assessment"
                                        data-testid="button-start-assessment"
                                    >
                                        Start Assessment
                                        <span
                                            class="icon icon-chevron-right"
                                        ></span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Assessment Section -->
                <div id="assessment-section" class="fade-in hidden">
                    <div class="card">
                        <div class="card-content">
                            <div class="question-card">
                                <h3
                                    class="question-title"
                                    id="question-title"
                                ></h3>
                                <p
                                    class="question-subtitle"
                                    id="question-subtitle"
                                ></p>
                            </div>

                            <div class="options-list" id="options-list">
                                <!-- Options will be dynamically added here -->
                            </div>

                            <div class="question-nav">
                                <button
                                    class="btn btn-ghost"
                                    id="prev-btn"
                                    data-testid="button-previous"
                                >
                                    <span class="icon icon-chevron-left"></span>
                                    Previous
                                </button>

                                <div class="question-counter">
                                    <span id="current-question">1</span> of
                                    <span id="total-questions">5</span>
                                </div>

                                <button
                                    class="btn btn-primary"
                                    id="next-btn"
                                    data-testid="button-next"
                                    disabled
                                >
                                    Next
                                    <span
                                        class="icon icon-chevron-right"
                                    ></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recommendation Section -->
                <div id="recommendation-section" class="fade-in hidden">
                    <div class="card">
                        <div class="card-content">
                            <div class="recommendation-header">
                                <div class="recommendation-icon">üí°</div>
                                <h2 class="recommendation-title">
                                    Your Recommendation
                                </h2>
                            </div>

                            <div
                                class="platform-card-large"
                                data-testid="recommended-platform"
                            >
                                <div
                                    class="platform-icon-large"
                                    id="platform-icon-large"
                                >
                                    M
                                </div>
                                <h3
                                    class="platform-name"
                                    id="platform-name"
                                ></h3>
                                <p
                                    class="platform-description"
                                    id="platform-description"
                                ></p>

                                <div class="benefits-card">
                                    <h4 class="benefits-title">
                                        Key Benefits for Your Use Case:
                                    </h4>
                                    <ul
                                        class="benefits-list"
                                        id="benefits-list"
                                    >
                                        <!-- Benefits will be dynamically added here -->
                                    </ul>
                                </div>
                            </div>

                            <!-- 1st Party Agents Section (shows for Microsoft 365 Copilot) -->
                            <div
                                id="first-party-agents"
                                class="first-party-agents-section hidden"
                                style="
                                    background-color: hsl(var(--muted));
                                    border-radius: var(--radius);
                                    padding: 24px;
                                    margin-bottom: 24px;
                                "
                            >
                                <h4
                                    style="
                                        font-weight: 600;
                                        color: hsl(var(--foreground));
                                        margin-bottom: 16px;
                                        display: flex;
                                        align-items: center;
                                        gap: 8px;
                                    "
                                >
                                    <span class="icon">ü§ñ</span> Available 1st
                                    Party Copilot Agents
                                </h4>
                                <div
                                    id="agents-grid"
                                    style="
                                        display: grid;
                                        grid-template-columns: repeat(
                                            auto-fit,
                                            minmax(280px, 1fr)
                                        );
                                        gap: 12px;
                                    "
                                >
                                    <!-- 1st party agents will be dynamically added here -->
                                </div>
                            </div>

                            <div
                                class="reasoning-section"
                                data-testid="reasoning-section"
                            >
                                <h3 class="reasoning-title">
                                    <span class="icon">üìà</span> Why This
                                    Recommendation?
                                </h3>
                                <ul class="reasoning-list" id="reasoning-list">
                                    <!-- Reasoning will be dynamically added here -->
                                </ul>

                                <div class="next-steps-card">
                                    <h4 class="next-steps-title">
                                        <span class="icon">‚ÑπÔ∏è</span> Next Steps
                                    </h4>
                                    <p class="next-steps-text">
                                        Plan your agent structure to define the
                                        architecture and components before
                                        implementing.
                                    </p>
                                </div>
                            </div>

                            <div class="center">
                                <button class="btn btn-ghost" id="back-to-assessment" data-testid="button-back-to-assessment">
                                    <span class="icon icon-chevron-left"></span> Back to Assessment
                                </button>
                                <button
                                    class="btn btn-primary btn-lg"
                                    id="view-structure"
                                    data-testid="button-view-structure"
                                >
                                    Plan Agent Structure
                                    <span
                                        class="icon icon-chevron-right"
                                    ></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Implementation Section -->
                <div id="implementation-section" class="fade-in hidden">
                    <div class="card">
                        <div class="card-content">
                            <h2 class="checklist-title">
                                <span class="icon">‚úÖ</span> Implementation
                                Checklist
                            </h2>

                            <div class="checklist-grid">
                                <div class="checklist-section">
                                    <h3 class="checklist-section-title">
                                        <span class="icon">‚úÖ</span>
                                        Pre-Development
                                    </h3>
                                    <ul
                                        class="checklist-items"
                                        id="predev-checklist"
                                        data-testid="predev-checklist"
                                    >
                                        <!-- Pre-dev items will be dynamically added here -->
                                    </ul>
                                </div>

                                <div class="checklist-section">
                                    <h3 class="checklist-section-title">
                                        <span class="icon">üöÄ</span>
                                        Post-Development
                                    </h3>
                                    <ul
                                        class="checklist-items"
                                        id="postdev-checklist"
                                        data-testid="postdev-checklist"
                                    >
                                        <!-- Post-dev items will be dynamically added here -->
                                    </ul>
                                </div>
                            </div>

                            <div class="separator"></div>

                            <div class="center">
                                <button class="btn btn-ghost" id="back-to-structure" data-testid="button-back-to-structure">
                                    <span class="icon icon-chevron-left"></span> Back to Structure
                                </button>
                                <button
                                    class="btn btn-secondary"
                                    id="restart-btn"
                                    data-testid="button-restart"
                                >
                                    <span class="icon icon-restart"></span>
                                    Start Over
                                </button>
                                <button
                                    class="btn btn-primary"
                                    id="export-btn"
                                    data-testid="button-export"
                                >
                                    <span class="icon icon-download"></span>
                                    Export Word Document
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Agent Structure Section -->
                <div id="structure-section" class="fade-in hidden">
                    <div class="card">
                        <div class="card-content">
                            <h2 class="structure-title">
                                <span class="icon">üîó</span> Agent Structure
                                Planning
                            </h2>

                            <div id="platform-specific-structure">
                                <!-- Platform-specific content will be dynamically inserted here -->
                            </div>

                            <div class="separator"></div>

                            <div class="center">
                                <button class="btn btn-ghost" id="back-to-recommendation" data-testid="button-back-to-recommendation">
                                    <span class="icon icon-chevron-left"></span> Back to Recommendation
                                </button>
                                <button
                                    class="btn btn-primary btn-lg"
                                    id="structure-to-implementation"
                                    data-testid="button-structure-to-implementation"
                                >
                                    View Implementation Guide
                                    <span
                                        class="icon icon-chevron-right"
                                    ></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <script>
            // Application Data - Updated based on Microsoft AI Agent Decision Matrix
            const questions = [
                {
                    id: "primaryPurpose",
                    title: "What is your primary purpose for the AI agent?",
                    subtitle:
                        "This helps determine which platform aligns with your core objectives",
                    options: [
                        {
                            id: "productivity",
                            label: "Personal productivity assistance",
                            description:
                                "Writing assistance, data analysis, and information retrieval within Office workflows",
                        },
                        {
                            id: "organizational",
                            label: "Organizational knowledge and simple tasks",
                            description:
                                "Handle internal FAQs, specialized queries, or basic integrations for your organization",
                        },
                        {
                            id: "business_process",
                            label: "Custom business process automation",
                            description:
                                "Specific workflow automation with conversational interfaces and action-taking capabilities",
                        },
                        {
                            id: "enterprise_ai",
                            label: "Enterprise AI/ML platform capabilities",
                            description:
                                "Bespoke AI solutions, model training, complex multi-step agents, and advanced analytics",
                        },
                    ],
                },
                {
                    id: "targetAudience",
                    title: "Who is your primary target audience?",
                    subtitle:
                        "Consider the technical skill level and role of your users",
                    options: [
                        {
                            id: "end_users",
                            label: "End-users & knowledge workers",
                            description:
                                "Employees who want AI assistance in everyday Microsoft 365 tasks",
                        },
                        {
                            id: "business_users",
                            label: "Business users in the organization",
                            description:
                                "Teams who need company-specific knowledge and simple automations",
                        },
                        {
                            id: "business_analysts",
                            label: "Business analysts & Power Platform makers",
                            description:
                                "IT teams creating custom departmental solutions with minimal code",
                        },
                        {
                            id: "developers",
                            label: "Software developers & data scientists",
                            description:
                                "Technical teams building advanced AI solutions with full control",
                        },
                    ],
                },
                {
                    id: "complexityLevel",
                    title: "What level of complexity do you need?",
                    subtitle:
                        "Consider development effort, customization, and technical requirements",
                    options: [
                        {
                            id: "lowest",
                            label: "Lowest - Turn it on and use",
                            description:
                                "No customization needed, pre-defined behavior and scope",
                        },
                        {
                            id: "low",
                            label: "Low - Configure with your content",
                            description:
                                "Add connectors or data sources with guided setup process",
                        },
                        {
                            id: "moderate",
                            label: "Moderate - Custom workflows and logic",
                            description:
                                "Build conversational agents with custom behaviors and integrations",
                        },
                        {
                            id: "highest",
                            label: "Highest - Full software development",
                            description:
                                "Custom architecture, model training, and enterprise-grade development",
                        },
                    ],
                },
                {
                    id: "integrationScope",
                    title: "What are your integration requirements?",
                    subtitle:
                        "Consider your data sources and system connectivity needs",
                    options: [
                        {
                            id: "microsoft_graph",
                            label: "Microsoft 365 and Graph data only",
                            description:
                                "Work with emails, Teams, SharePoint, OneDrive within M365 permissions",
                        },
                        {
                            id: "extended_microsoft",
                            label: "Extended Microsoft ecosystem",
                            description:
                                "Microsoft Graph + some internal knowledge bases and limited plugins",
                        },
                        {
                            id: "power_platform",
                            label: "Power Platform connectors",
                            description:
                                "1400+ connectors, APIs, Dataverse, and various enterprise systems",
                        },
                        {
                            id: "unlimited",
                            label: "Unlimited integration freedom",
                            description:
                                "Any data source, API, database, or system that can be coded",
                        },
                    ],
                },
                {
                    id: "deploymentNeeds",
                    title: "What are your deployment requirements?",
                    subtitle:
                        "Consider where and how users will access your agent",
                    options: [
                        {
                            id: "microsoft_managed",
                            label: "Microsoft-managed within M365",
                            description:
                                "Built into Office apps - Word, Teams, Outlook sidebar/chat",
                        },
                        {
                            id: "microsoft_hosted",
                            label: "Microsoft-hosted in M365 environment",
                            description:
                                "Accessed via Copilot Chat interfaces but with custom capabilities",
                        },
                        {
                            id: "multiple_channels",
                            label: "Multiple channels and touchpoints",
                            description:
                                "Teams, SharePoint, web pages, and custom interfaces",
                        },
                        {
                            id: "anywhere",
                            label: "Deploy anywhere",
                            description:
                                "Web apps, mobile apps, Teams apps, chatbots, or custom integrations",
                        },
                    ],
                },
            ];

            const platformOptions = {
                microsoft365copilot: {
                    id: "microsoft365copilot",
                    name: "Microsoft 365 Copilot",
                    icon: "users",
                    color: "blue",
                    description:
                        "Built-in productivity assistant across Microsoft 365 apps.",
                    benefits: [
                        "Immediate deployment",
                        "No development required",
                        "Works with existing M365 data",
                        "Standard security & compliance",
                    ],
                    reasoning: [],
                },
                agentbuilder: {
                    id: "agentbuilder",
                    name: "Microsoft 365 Copilot with Copilot Studio Agent Builder",
                    icon: "wrench",
                    color: "green",
                    description:
                        "Extend Copilot beyond the 11+ built-in agents with custom organizational knowledge and company-specific capabilities",
                    benefits: [
                        "Lightweight customization without code for needs beyond 1st party agents",
                        "Organizational Q&A from custom knowledge bases and internal documents",
                        "Simple task execution through plugins and flows",
                        "Stays within familiar Copilot UI for users",
                        "Connect SharePoint libraries, internal systems, and specialized FAQ documents",
                    ],
                    reasoning: [],
                },
                copilotstudio: {
                    id: "copilotstudio",
                    name: "Microsoft Copilot Studio",
                    icon: "paint-brush",
                    color: "purple",
                    description:
                        "Intuitive, natural language building experience for creating custom conversational agents with advanced workflows and multi-channel deployment",
                    benefits: [
                        "Full conversational agent capabilities with branching dialogues",
                        "Access to 1400+ Power Platform connectors",
                        "Multi-channel deployment (Teams, web, SharePoint)",
                        "Action-taking capabilities through Power Automate",
                        "Visual conversation design and custom prompt engineering",
                    ],
                    reasoning: [],
                },
                azureai: {
                    id: "azureai",
                    name: "Azure AI Foundry Agent Service",
                    icon: "cloud",
                    color: "indigo",
                    description:
                        "Enterprise AI/ML platform for building bespoke AI solutions with complete development control and advanced capabilities",
                    benefits: [
                        "Unlimited integration freedom with any data source or system",
                        "Custom model training, fine-tuning, and deployment",
                        "Advanced features like RAG, custom decision logic, and autonomous agents",
                        "Enterprise-grade scalability with comprehensive monitoring",
                        "Full software development flexibility and control",
                    ],
                    reasoning: [],
                },
            };

            const implementationChecklists = {
                microsoft365copilot: {
                    predev: [
                        "Verify Microsoft 365 Copilot licensing for target users",
                        "Identify which of the 11+ 1st party agents match your use case (Sales, Finance, HR, etc.)",
                        "Review data access permissions and Microsoft Graph connectivity",
                        "Enable Bing integration if web search capabilities are needed",
                        "Configure approved SharePoint sites and data sources for specialized agents",
                        "Plan user onboarding and training for Office app and specialized agent integration",
                    ],
                    postdev: [
                        "Monitor Copilot and specialized agent usage analytics within M365 admin center",
                        "Track adoption of specific 1st party agents (Sales, Service, Finance, HR, etc.)",
                        "Collect user feedback on productivity improvements across specialized agents",
                        "Ensure data governance policies are being followed for all agent types",
                        "Provide ongoing support for users learning Copilot and specialized agent features",
                    ],
                },
                agentbuilder: {
                    predev: [
                        "Define organizational knowledge sources and FAQ content",
                        "Identify internal SharePoint libraries and document sources",
                        "Plan Graph Connector setup for external knowledge bases",
                        "Design simple conversation flows for company-specific queries",
                        "Configure permissions for organizational data access",
                    ],
                    postdev: [
                        "Deploy agent capabilities within Copilot Chat experience",
                        "Monitor organizational query patterns and response accuracy",
                        "Update knowledge sources and refine agent responses",
                        "Measure user satisfaction with company-specific AI assistance",
                        "Scale to additional departments based on success metrics",
                    ],
                },
                copilotstudio: {
                    predev: [
                        "Map out conversational flows and user journey scenarios",
                        "Identify required Power Platform connectors (from 1400+ available)",
                        "Design agent personality, tone, and response patterns",
                        "Plan integration with Dataverse, APIs, and business systems",
                        "Set up development and testing environments in Power Platform",
                    ],
                    postdev: [
                        "Deploy to Teams, SharePoint, or web channels as planned",
                        "Implement comprehensive analytics and conversation tracking",
                        "Monitor connector performance and system integrations",
                        "Continuously optimize conversation flows based on user interactions",
                        "Plan expansion to additional channels and use cases",
                    ],
                },
                azureai: {
                    predev: [
                        "Design AI architecture including RAG, custom models, and data pipelines",
                        "Plan Azure infrastructure, compute resources, and cost management",
                        "Architect data integration patterns for enterprise systems",
                        "Establish MLOps pipelines for model training and deployment",
                        "Create comprehensive security, monitoring, and governance frameworks",
                    ],
                    postdev: [
                        "Deploy to production with full observability and alerting",
                        "Implement model performance monitoring and retraining pipelines",
                        "Establish CI/CD for continuous integration and deployment",
                        "Monitor costs, performance metrics, and resource utilization",
                        "Maintain model accuracy and implement feedback loops for improvement",
                    ],
                },
            };

            // Application State
            let currentStep = 0;
            let currentQuestionIndex = 0;
            let answers = {};
            let recommendedPlatform = null;
            let isDarkTheme = false;
            let structurePlanningData = {};

            // 1st Party Copilot Agents - Available out-of-the-box
            const firstPartyCopilots = {
                sales_crm: {
                    name: "Copilot for Sales",
                    description:
                        "Integrates with Dynamics 365 and Salesforce to assist with CRM tasks",
                },
                customer_service: {
                    name: "Copilot for Service",
                    description:
                        "Supports customer service workflows and case resolution",
                },
                finance_reporting: {
                    name: "Copilot for Finance",
                    description: "Helps with financial reporting and analysis",
                },
                research_content: {
                    name: "Researcher Agent",
                    description: "Synthesizes information and drafts content",
                },
                data_analysis: {
                    name: "Analyst Agent",
                    description:
                        "Transforms data into insights and visualizations",
                },
                meeting_facilitation: {
                    name: "Facilitator Agent",
                    description:
                        "Manages Teams meetings, notes, and moderation",
                },
                hr_it_selfservice: {
                    name: "Employee Self-Service Agent",
                    description:
                        "Handles HR and IT tasks like PTO requests and helpdesk tickets",
                },
                sharepoint_access: {
                    name: "SharePoint Agents",
                    description:
                        "Provide natural language access to SharePoint content",
                },
                interpretation: {
                    name: "Interpreter Agent",
                    description:
                        "Enables real-time speech-to-speech interpretation in Teams",
                },
                project_management: {
                    name: "Project Manager Agent",
                    description: "Automate project management tasks in Planner",
                },
                skills_expertise: {
                    name: "Skills Agent",
                    description:
                        "Explore organizational skills and find expertise",
                },
            };

            // Platform-specific structure planning content
            const platformStructures = {
                microsoft365copilot: {
                    title: "1st Party Agent Configuration",
                    sections: [
                        {
                            title: "Agent Selection & Setup",
                            icon: "ü§ñ",
                            components: [
                                {
                                    title: "License Verification",
                                    icon: "üìã",
                                    color: "#3b82f6",
                                    description:
                                        "Verify Microsoft 365 Copilot licensing for target users and roles",
                                },
                                {
                                    title: "Agent Enablement",
                                    icon: "‚ö°",
                                    color: "#22c55e",
                                    description:
                                        "Enable specific 1st party agents (Sales, Finance, HR, etc.) based on user needs",
                                },
                                {
                                    title: "Data Permissions",
                                    icon: "üîê",
                                    color: "#f97316",
                                    description:
                                        "Configure Microsoft Graph permissions and data access for specialized agents",
                                },
                                {
                                    title: "SharePoint Integration",
                                    icon: "üìö",
                                    color: "#a855f7",
                                    description:
                                        "Connect SharePoint sites and document libraries for agent knowledge sources",
                                },
                            ],
                        },
                        {
                            title: "Usage & Deployment",
                            icon: "üöÄ",
                            components: [
                                {
                                    title: "User Training",
                                    icon: "üë•",
                                    color: "#3b82f6",
                                    description:
                                        "Plan training for Office apps integration and specialized agent features",
                                },
                                {
                                    title: "Governance Policies",
                                    icon: "‚öñÔ∏è",
                                    color: "#22c55e",
                                    description:
                                        "Establish data governance and usage policies across all agent types",
                                },
                                {
                                    title: "Analytics Setup",
                                    icon: "üìä",
                                    color: "#f97316",
                                    description:
                                        "Configure M365 admin center monitoring for agent usage and adoption",
                                },
                            ],
                        },
                    ],
                },
                agentbuilder: {
                    title: "Custom M365 Agent Architecture",
                    sections: [
                        {
                            title: "Knowledge & Data Sources",
                            icon: "üìö",
                            components: [
                                {
                                    title: "Organizational Knowledge",
                                    icon: "üè¢",
                                    color: "#3b82f6",
                                    description:
                                        "Define internal FAQ content and organizational-specific information",
                                },
                                {
                                    title: "SharePoint Libraries",
                                    icon: "üìÅ",
                                    color: "#22c55e",
                                    description:
                                        "Connect to internal SharePoint document libraries and knowledge bases",
                                },
                                {
                                    title: "Microsoft Graph APIs",
                                    icon: "üîó",
                                    color: "#f97316",
                                    description:
                                        "Configure Graph API connections for calendar, email, and team data",
                                },
                                {
                                    title: "Custom Data Sources",
                                    icon: "üóÑÔ∏è",
                                    color: "#a855f7",
                                    description:
                                        "Integrate external systems and databases through approved connectors",
                                },
                            ],
                        },
                        {
                            title: "Agent Behavior & Deployment",
                            icon: "‚öôÔ∏è",
                            components: [
                                {
                                    title: "Response Templates",
                                    icon: "üìù",
                                    color: "#3b82f6",
                                    description:
                                        "Design standardized response patterns and organizational tone",
                                },
                                {
                                    title: "Access Controls",
                                    icon: "üîí",
                                    color: "#22c55e",
                                    description:
                                        "Set user permissions and data access levels within M365 ecosystem",
                                },
                                {
                                    title: "Testing & Validation",
                                    icon: "üß™",
                                    color: "#f97316",
                                    description:
                                        "Test agent responses with organizational stakeholders before deployment",
                                },
                            ],
                        },
                    ],
                },
                copilotstudio: {
                    title: "Conversational Agent Design",
                    sections: [
                        {
                            title: "Conversation Architecture",
                            icon: "üí¨",
                            components: [
                                {
                                    title: "Topics & Intents",
                                    icon: "üéØ",
                                    color: "#3b82f6",
                                    description:
                                        "Define conversation topics and user intent recognition patterns",
                                },
                                {
                                    title: "Dialog Flows",
                                    icon: "üåä",
                                    color: "#22c55e",
                                    description:
                                        "Map out conversation pathways and decision trees",
                                },
                                {
                                    title: "Fallback Handling",
                                    icon: "üîÑ",
                                    color: "#f97316",
                                    description:
                                        "Design graceful fallback responses for unrecognized queries",
                                },
                                {
                                    title: "Entity Extraction",
                                    icon: "üîç",
                                    color: "#a855f7",
                                    description:
                                        "Configure data extraction from user messages (dates, names, etc.)",
                                },
                            ],
                        },
                        {
                            title: "Multi-Channel Deployment",
                            icon: "üì°",
                            components: [
                                {
                                    title: "Teams Integration",
                                    icon: "üë•",
                                    color: "#3b82f6",
                                    description:
                                        "Configure bot deployment within Microsoft Teams environment",
                                },
                                {
                                    title: "Web Chat Widget",
                                    icon: "üåê",
                                    color: "#22c55e",
                                    description:
                                        "Embed conversational interface in websites and web portals",
                                },
                                {
                                    title: "SharePoint Integration",
                                    icon: "üìö",
                                    color: "#f97316",
                                    description:
                                        "Deploy agent within SharePoint sites for contextual assistance",
                                },
                                {
                                    title: "Power Platform Connectors",
                                    icon: "‚ö°",
                                    color: "#a855f7",
                                    description:
                                        "Integrate with Power Automate flows and Power Apps",
                                },
                            ],
                        },
                    ],
                },
                azureai: {
                    title: "Enterprise AI Solution Architecture",
                    sections: [
                        {
                            title: "AI & ML Components",
                            icon: "ü§ñ",
                            components: [
                                {
                                    title: "Model Selection",
                                    icon: "üß†",
                                    color: "#3b82f6",
                                    description:
                                        "Choose appropriate Azure OpenAI models and configure custom fine-tuning",
                                },
                                {
                                    title: "RAG Pipeline",
                                    icon: "üîç",
                                    color: "#22c55e",
                                    description:
                                        "Design retrieval-augmented generation with Azure AI Search integration",
                                },
                                {
                                    title: "Vector Databases",
                                    icon: "üóÑÔ∏è",
                                    color: "#f97316",
                                    description:
                                        "Configure Azure Cosmos DB for vector storage and similarity search",
                                },
                                {
                                    title: "Custom Models",
                                    icon: "‚öôÔ∏è",
                                    color: "#a855f7",
                                    description:
                                        "Plan custom model training pipelines using Azure Machine Learning",
                                },
                            ],
                        },
                        {
                            title: "Enterprise Infrastructure",
                            icon: "üèóÔ∏è",
                            components: [
                                {
                                    title: "Security & Compliance",
                                    icon: "üîí",
                                    color: "#3b82f6",
                                    description:
                                        "Implement enterprise security policies and regulatory compliance",
                                },
                                {
                                    title: "Scalability Design",
                                    icon: "üìà",
                                    color: "#22c55e",
                                    description:
                                        "Plan auto-scaling policies and resource management strategies",
                                },
                                {
                                    title: "Monitoring & Logging",
                                    icon: "üìä",
                                    color: "#f97316",
                                    description:
                                        "Set up Application Insights and custom performance dashboards",
                                },
                                {
                                    title: "CI/CD Pipelines",
                                    icon: "üîÑ",
                                    color: "#a855f7",
                                    description:
                                        "Establish MLOps workflows for continuous integration and deployment",
                                },
                            ],
                        },
                    ],
                },
            };

            // Check if user needs are covered by 1st party agents
            function checkFirstPartyAgentCoverage(answers) {
                const coveredUseCase = {
                    isFirstPartyCovered: false,
                    matchingAgent: null,
                    reason: "",
                };

                // Check if the primary purpose aligns with existing 1st party agents
                if (answers.primaryPurpose === "productivity") {
                    // Most productivity use cases are covered by out-of-the-box Copilot or 1st party agents
                    coveredUseCase.isFirstPartyCovered = true;
                    coveredUseCase.reason =
                        "Personal productivity is comprehensively covered by Microsoft 365 Copilot and specialized 1st party agents";
                }

                return coveredUseCase;
            }

            // Platform determination logic - Updated with 1st Party Agent consideration
            function determinePlatform(answers) {
                let bestMatch = null;

                // First, check if needs are already covered by 1st party agents
                const firstPartyCheck = checkFirstPartyAgentCoverage(answers);

                // Microsoft 365 Copilot - Enhanced with 1st party agent consideration
                if (
                    (answers.primaryPurpose === "productivity" &&
                        answers.targetAudience === "end_users" &&
                        answers.complexityLevel === "lowest") ||
                    (firstPartyCheck.isFirstPartyCovered &&
                        answers.complexityLevel === "lowest")
                ) {
                    bestMatch = { ...platformOptions.microsoft365copilot };
                    bestMatch.reasoning = [
                        "Personal productivity focus aligns with Copilot's core purpose",
                        "Specialized 1st party agents cover sales, finance, HR, project management, and more",
                        "End-users benefit from zero-effort AI integration in Office apps",
                        "Lowest complexity matches out-of-the-box functionality",
                    ];
                    if (firstPartyCheck.isFirstPartyCovered) {
                        bestMatch.reasoning.push(
                            "Your use case is likely covered by existing 1st party Copilot agents",
                        );
                    }
                }
                // Microsoft 365 Copilot with Copilot Studio Lite - Only when needs exceed 1st party agents
                else if (
                    answers.primaryPurpose === "organizational" &&
                    answers.targetAudience === "business_users" &&
                    (answers.complexityLevel === "low" ||
                        answers.complexityLevel === "lowest") &&
                    (answers.integrationScope === "microsoft_graph" ||
                        answers.integrationScope === "extended_microsoft") &&
                    !firstPartyCheck.isFirstPartyCovered
                ) {
                    bestMatch = { ...platformOptions.agentbuilder };
                    bestMatch.reasoning = [
                        "Your organizational needs go beyond existing 1st party Copilot agents",
                        "Company-specific knowledge extension fits Copilot Studio Lite's purpose",
                        "Business users benefit from custom AI capabilities within familiar Copilot UI",
                        "Low complexity aligns with guided configuration approach",
                        "Microsoft ecosystem focus matches platform capabilities",
                    ];
                }
                // Copilot Studio
                else if (
                    answers.primaryPurpose === "business_process" &&
                    answers.targetAudience === "business_analysts" &&
                    answers.complexityLevel === "moderate" &&
                    answers.integrationScope === "power_platform"
                ) {
                    bestMatch = { ...platformOptions.copilotstudio };
                    bestMatch.reasoning = [
                        "Custom business process automation is Copilot Studio's strength",
                        "Business analysts can leverage intuitive, natural language building experience",
                        "Moderate complexity matches visual conversation design capabilities",
                        "Power Platform connectors provide extensive integration options",
                    ];
                }
                // Azure AI Foundry
                else if (
                    answers.primaryPurpose === "enterprise_ai" &&
                    answers.targetAudience === "developers" &&
                    answers.complexityLevel === "highest" &&
                    answers.integrationScope === "unlimited"
                ) {
                    bestMatch = { ...platformOptions.azureai };
                    bestMatch.reasoning = [
                        "Enterprise AI/ML platform needs require Azure AI Foundry's capabilities",
                        "Developers need full control for advanced AI solution development",
                        "Highest complexity demands software development approach",
                        "Unlimited integration freedom enables comprehensive enterprise solutions",
                    ];
                }

                // Additional logic based on specific combinations
                if (!bestMatch) {
                    // Copilot Studio for multi-channel deployment needs
                    if (
                        answers.deploymentNeeds === "multiple_channels" &&
                        answers.complexityLevel === "moderate"
                    ) {
                        bestMatch = { ...platformOptions.copilotstudio };
                        bestMatch.reasoning = [
                            "Multi-channel deployment capabilities are Copilot Studio's strength",
                            "Moderate complexity allows for sophisticated conversational agents",
                            "Teams, SharePoint, and web deployment options available",
                        ];
                    }
                    // Azure AI for unlimited deployment needs
                    else if (
                        answers.deploymentNeeds === "anywhere" &&
                        answers.integrationScope === "unlimited"
                    ) {
                        bestMatch = { ...platformOptions.azureai };
                        bestMatch.reasoning = [
                            "Deploy anywhere capability requires full development control",
                            "Unlimited integration scope demands enterprise platform",
                            "Custom applications and advanced AI features needed",
                        ];
                    }
                    // Copilot Studio Lite for extended Microsoft integration (only if not covered by 1st party agents)
                    else if (
                        answers.integrationScope === "extended_microsoft" &&
                        answers.complexityLevel === "low" &&
                        !firstPartyCheck.isFirstPartyCovered
                    ) {
                        bestMatch = { ...platformOptions.agentbuilder };
                        bestMatch.reasoning = [
                            "Extended Microsoft ecosystem fits Copilot Studio Lite capabilities",
                            "Your needs go beyond the 11+ available 1st party Copilot agents",
                            "Low complexity configuration within M365 environment",
                            "Company-specific knowledge augmentation",
                        ];
                    }
                }

                // Final fallback logic - Consider 1st party agent coverage
                if (!bestMatch) {
                    if (
                        answers.complexityLevel === "lowest" ||
                        firstPartyCheck.isFirstPartyCovered
                    ) {
                        bestMatch = { ...platformOptions.microsoft365copilot };
                        bestMatch.reasoning =
                            firstPartyCheck.isFirstPartyCovered
                                ? [
                                      "Your use case is likely covered by Microsoft's 11+ built-in Copilot agents",
                                      "Lowest complexity requirements match out-of-the-box capabilities",
                                  ]
                                : [
                                      "Lowest complexity requirements match out-of-the-box Copilot capabilities",
                                  ];
                    } else if (answers.complexityLevel === "highest") {
                        bestMatch = { ...platformOptions.azureai };
                        bestMatch.reasoning = [
                            "Highest complexity requirements need enterprise development platform",
                        ];
                    } else if (answers.targetAudience === "developers") {
                        bestMatch = { ...platformOptions.azureai };
                        bestMatch.reasoning = [
                            "Developer audience benefits from full control and customization options",
                        ];
                    } else {
                        bestMatch = { ...platformOptions.copilotstudio };
                        bestMatch.reasoning = [
                            "Balanced intuitive, natural language building experience suitable for most business scenarios",
                        ];
                    }
                }

                return bestMatch;
            }

            // DOM manipulation functions
            function showSection(sectionId) {
                document
                    .querySelectorAll('[id$="-section"]')
                    .forEach((section) => {
                        section.classList.add("hidden");
                    });
                document.getElementById(sectionId).classList.remove("hidden");
            }

            function updateProgressIndicator() {
                const steps = document.querySelectorAll(".step-circle");
                steps.forEach((step, index) => {
                    const stepNum = parseInt(step.getAttribute("data-step"));
                    step.className = "step-circle";

                    if (stepNum < currentStep) {
                        step.classList.add("completed");
                        step.innerHTML = "‚úì";
                    } else if (stepNum === currentStep) {
                        step.classList.add("active");
                        step.innerHTML = stepNum + 1;
                    } else {
                        step.classList.add("pending");
                        step.innerHTML = stepNum + 1;
                    }
                });
            }

            function renderQuestion() {
                const question = questions[currentQuestionIndex];
                document.getElementById("question-title").textContent =
                    question.title;
                document.getElementById("question-subtitle").textContent =
                    question.subtitle;
                document.getElementById("current-question").textContent =
                    currentQuestionIndex + 1;
                document.getElementById("total-questions").textContent =
                    questions.length;

                const optionsList = document.getElementById("options-list");
                optionsList.innerHTML = "";

                question.options.forEach((option) => {
                    const optionElement = document.createElement("div");
                    optionElement.className = `option-card ${answers[question.id] === option.id ? "selected" : ""}`;
                    optionElement.setAttribute(
                        "data-testid",
                        `option-${option.id}`,
                    );

                    optionElement.innerHTML = `
                    <input type="radio" 
                           name="${question.id}" 
                           value="${option.id}" 
                           class="option-radio"
                           data-testid="radio-${option.id}"
                           ${answers[question.id] === option.id ? "checked" : ""}>
                    <div class="option-content">
                        <h4 class="option-label">${option.label}</h4>
                        <p class="option-description">${option.description}</p>
                    </div>
                `;

                    optionElement.addEventListener("click", () =>
                        selectOption(question.id, option.id),
                    );
                    optionsList.appendChild(optionElement);
                });

                // Update navigation buttons
                document.getElementById("prev-btn").disabled =
                    currentQuestionIndex === 0;
                document.getElementById("next-btn").disabled =
                    !answers[question.id];
                document.getElementById("next-btn").textContent =
                    currentQuestionIndex === questions.length - 1
                        ? "Get Recommendation ‚ñ∂"
                        : "Next ‚ñ∂";
            }

            function selectOption(questionId, optionId) {
                answers[questionId] = optionId;
                renderQuestion();
            }

            function renderRecommendation() {
                recommendedPlatform = determinePlatform(answers);

                document.getElementById("platform-icon-large").textContent =
                    recommendedPlatform.name.charAt(0);
                document.getElementById("platform-name").textContent =
                    recommendedPlatform.name;
                document.getElementById("platform-description").textContent =
                    recommendedPlatform.description;

                const benefitsList = document.getElementById("benefits-list");
                benefitsList.innerHTML = "";
                recommendedPlatform.benefits.forEach((benefit) => {
                    const li = document.createElement("li");
                    li.className = "benefit-item";
                    li.innerHTML = `<span class="check-icon">‚úÖ</span><span class="benefit-text">${benefit}</span>`;
                    benefitsList.appendChild(li);
                });

                // Show 1st party agents if Microsoft 365 Copilot is recommended
                const firstPartySection =
                    document.getElementById("first-party-agents");
                if (recommendedPlatform.id === "microsoft365copilot") {
                    firstPartySection.classList.remove("hidden");
                    const agentsGrid = document.getElementById("agents-grid");
                    agentsGrid.innerHTML = "";

                    Object.values(firstPartyCopilots).forEach((agent) => {
                        const agentCard = document.createElement("div");
                        agentCard.style.cssText =
                            "background-color: hsl(var(--card)); border: 1px solid hsl(var(--border)); border-radius: var(--radius); padding: 12px;";
                        agentCard.innerHTML = `
                        <h5 style="font-weight: 600; color: hsl(var(--foreground)); margin-bottom: 4px; font-size: 14px;">${agent.name}</h5>
                        <p style="font-size: 12px; color: hsl(var(--muted-foreground)); margin: 0;">${agent.description}</p>
                    `;
                        agentsGrid.appendChild(agentCard);
                    });
                } else {
                    firstPartySection.classList.add("hidden");
                }

                const reasoningList = document.getElementById("reasoning-list");
                reasoningList.innerHTML = "";
                recommendedPlatform.reasoning.forEach((reason) => {
                    const li = document.createElement("li");
                    li.className = "reasoning-item";
                    li.innerHTML = `<span class="check-icon">‚úÖ</span><span class="reasoning-text">${reason}</span>`;
                    reasoningList.appendChild(li);
                });
            }

            function renderStructure() {
                const platformStructure =
                    platformStructures[recommendedPlatform.id];

                // Update the structure section title
                document.querySelector(".structure-title").innerHTML =
                    `<span class="icon">üîó</span> ${platformStructure.title}`;

                const structureContainer = document.getElementById(
                    "platform-specific-structure",
                );
                structureContainer.innerHTML = "";

                platformStructure.sections.forEach((section) => {
                    const sectionDiv = document.createElement("div");
                    sectionDiv.className = "structure-section";
                    sectionDiv.innerHTML = `
                    <h3 class="structure-section-title">
                        <span class="icon">${section.icon}</span> ${section.title}
                    </h3>
                    <div class="component-grid">
                        ${section.components
                            .map(
                                (component, componentIndex) => `
                            <div class="component-card">
                                <h4 class="component-title">
                                    <span class="icon" style="color: ${component.color};">${component.icon}</span> ${component.title}
                                </h4>
                                <p class="component-description">${component.description}</p>
                                <div class="component-controls">
                                    <div class="component-checkbox">
                                        <input type="checkbox" id="component-${section.title.replace(/\s+/g, "-").toLowerCase()}-${componentIndex}" 
                                               data-section="${section.title}" data-component="${component.title}"
                                               onchange="updateStructureData(this)">
                                        <label for="component-${section.title.replace(/\s+/g, "-").toLowerCase()}-${componentIndex}">Include in plan</label>
                                    </div>
                                    <textarea class="component-textarea" 
                                              placeholder="Add your specific implementation notes, decisions, or requirements for this component..."
                                              data-section="${section.title}" data-component="${component.title}"
                                              onchange="updateStructureData(this)"></textarea>
                                </div>
                            </div>
                        `,
                            )
                            .join("")}
                    </div>
                `;
                    structureContainer.appendChild(sectionDiv);
                });
            }

            function updateStructureData(element) {
                const section = element.getAttribute("data-section");
                const component = element.getAttribute("data-component");

                if (!structurePlanningData[section]) {
                    structurePlanningData[section] = {};
                }
                if (!structurePlanningData[section][component]) {
                    structurePlanningData[section][component] = {
                        selected: false,
                        notes: "",
                    };
                }

                if (element.type === "checkbox") {
                    structurePlanningData[section][component].selected =
                        element.checked;
                } else if (element.tagName === "TEXTAREA") {
                    structurePlanningData[section][component].notes =
                        element.value;
                }
            }

            function renderImplementation() {
                const checklist =
                    implementationChecklists[recommendedPlatform.id];

                const predevList = document.getElementById("predev-checklist");
                predevList.innerHTML = "";
                checklist.predev.forEach((item, index) => {
                    const li = document.createElement("li");
                    li.className = "checklist-item";
                    li.innerHTML = `
                    <input type="checkbox" class="checkbox" data-testid="predev-item-${index}">
                    <span class="checklist-item-text">${item}</span>
                `;
                    predevList.appendChild(li);
                });

                const postdevList =
                    document.getElementById("postdev-checklist");
                postdevList.innerHTML = "";
                checklist.postdev.forEach((item, index) => {
                    const li = document.createElement("li");
                    li.className = "checklist-item";
                    li.innerHTML = `
                    <input type="checkbox" class="checkbox" data-testid="postdev-item-${index}">
                    <span class="checklist-item-text">${item}</span>
                `;
                    postdevList.appendChild(li);
                });
            }

            function exportPlan() {
                const questionTitles = {
                    primaryPurpose: "Primary Purpose",
                    targetAudience: "Target Audience",
                    complexityLevel: "Complexity Level",
                    integrationScope: "Integration Scope",
                    deploymentNeeds: "Deployment Needs",
                };

                // Create RTF content for Word compatibility
                let rtf =
                    "{\\rtf1\\ansi\\deff0\\nouicompat{\\fonttbl{\\f0\\fswiss\\fcharset0 Arial;}}";
                rtf +=
                    "{\\colortbl;\\red0\\green0\\blue0;\\red0\\green0\\blue255;}";
                rtf += "\\viewkind4\\uc1\\pard\\f0\\fs24";

                // Title
                rtf +=
                    "\\qc\\b\\fs32 MICROSOFT AI AGENT PLATFORM PLAN\\b0\\fs24\\par\\par";
                rtf += `\\qc\\i Generated on: ${new Date().toLocaleDateString()}\\i0\\par\\par`;
                rtf += "\\ql"; // Left align for body text

                // Recommended Platform
                rtf += "\\b\\fs28 1. RECOMMENDED PLATFORM\\b0\\fs24\\par";
                rtf += "\\line";
                rtf += `\\b Platform: \\b0 ${recommendedPlatform.name}\\par\\par`;
                rtf += `\\b Description: \\b0 ${recommendedPlatform.description}\\par\\par`;

                // Assessment Results
                rtf += "\\b\\fs28 2. ASSESSMENT RESULTS\\b0\\fs24\\par";
                rtf += "\\line";
                Object.entries(answers).forEach(([key, value]) => {
                    rtf += `\\b ${questionTitles[key] || key}: \\b0 ${value.replace(/_/g, " ").toUpperCase()}\\par`;
                });
                rtf += "\\par";

                // Reasoning
                rtf += "\\b\\fs28 3. WHY THIS RECOMMENDATION?\\b0\\fs24\\par";
                rtf += "\\line";
                recommendedPlatform.reasoning.forEach((reason, index) => {
                    rtf += `${index + 1}. ${reason}\\par`;
                });
                rtf += "\\par";

                // Structure Planning (if any data captured)
                if (Object.keys(structurePlanningData).length > 0) {
                    rtf +=
                        "\\b\\fs28 4. AGENT STRUCTURE PLANNING\\b0\\fs24\\par";
                    rtf += "\\line";

                    Object.entries(structurePlanningData).forEach(
                        ([sectionTitle, components]) => {
                            rtf += `\\par\\b\\fs26 ${sectionTitle.toUpperCase()}\\b0\\fs24\\par`;

                            Object.entries(components).forEach(
                                ([componentTitle, data]) => {
                                    if (data.selected || data.notes) {
                                        rtf += `${data.selected ? "\\u9745?" : "\\u9744?"} ${componentTitle}\\par`;
                                        if (data.notes) {
                                            rtf += `\\tab\\i Notes: ${data.notes}\\i0\\par`;
                                        }
                                    }
                                },
                            );
                        },
                    );
                    rtf += "\\par";
                }

                // Implementation Checklist
                const checklist =
                    implementationChecklists[recommendedPlatform.id];
                const sectionNumber =
                    Object.keys(structurePlanningData).length > 0 ? "5" : "4";
                rtf += `\\b\\fs28 ${sectionNumber}. IMPLEMENTATION CHECKLIST\\b0\\fs24\\par`;
                rtf += "\\line";

                // Pre-development
                rtf += "\\par\\b\\fs26 PRE-DEVELOPMENT TASKS\\b0\\fs24\\par";
                checklist.predev.forEach((item, index) => {
                    rtf += `\\u9744? ${index + 1}. ${item}\\par`;
                });

                // Post-development
                rtf += "\\par\\b\\fs26 POST-DEVELOPMENT TASKS\\b0\\fs24\\par";
                checklist.postdev.forEach((item, index) => {
                    rtf += `\\u9744? ${index + 1}. ${item}\\par`;
                });

                rtf += "\\par\\line\\par";
                rtf +=
                    "\\qc\\i This plan was generated by the Microsoft Agent Platform Decision Tool\\i0\\par";
                rtf += "}";

                // Create and download RTF file
                const blob = new Blob([rtf], { type: "application/rtf" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = `agent-platform-plan-${new Date().toISOString().split("T")[0]}.rtf`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            function restart() {
                currentStep = 0;
                currentQuestionIndex = 0;
                answers = {};
                recommendedPlatform = null;
                structurePlanningData = {};
                updateProgressIndicator();
                showSection("welcome-section");
            }

            function toggleTheme() {
                isDarkTheme = !isDarkTheme;
                document.documentElement.classList.toggle("dark");
                document.getElementById("theme-icon").className = isDarkTheme
                    ? "icon icon-sun"
                    : "icon icon-moon";
            }

            // Event Listeners
            document.addEventListener("DOMContentLoaded", function () {
                // Initialize
                updateProgressIndicator();

                // Theme toggle
                document
                    .getElementById("theme-toggle")
                    .addEventListener("click", toggleTheme);

                // Welcome section
                document
                    .getElementById("start-assessment")
                    .addEventListener("click", function () {
                        currentStep = 1;
                        currentQuestionIndex = 0;
                        updateProgressIndicator();
                        renderQuestion();
                        showSection("assessment-section");
                    });

                // Assessment navigation
                document
                    .getElementById("prev-btn")
                    .addEventListener("click", function () {
                        if (currentQuestionIndex > 0) {
                            currentQuestionIndex--;
                            renderQuestion();
                        }
                    });

                document
                    .getElementById("next-btn")
                    .addEventListener("click", function () {
                        if (currentQuestionIndex < questions.length - 1) {
                            currentQuestionIndex++;
                            renderQuestion();
                        } else {
                            // Assessment complete
                            currentStep = 2;
                            updateProgressIndicator();
                            renderRecommendation();
                            showSection("recommendation-section");
                        }
                    });

                // Recommendation section
                document
                    .getElementById("view-structure")
                    .addEventListener("click", function () {
                        currentStep = 3;
                        updateProgressIndicator();
                        renderStructure();
                        showSection("structure-section");
                    });

                // Structure section
                document
                    .getElementById("structure-to-implementation")
                    .addEventListener("click", function () {
                        currentStep = 4;
                        updateProgressIndicator();
                        renderImplementation();
                        showSection("implementation-section");
                    });

                // Back button handlers
                document
                    .getElementById("back-to-assessment")
                    .addEventListener("click", function () {
                        currentStep = 1;
                        updateProgressIndicator();
                        showSection("assessment-section");
                    });

                document
                    .getElementById("back-to-recommendation")
                    .addEventListener("click", function () {
                        currentStep = 2;
                        updateProgressIndicator();
                        showSection("recommendation-section");
                    });

                document
                    .getElementById("back-to-structure")
                    .addEventListener("click", function () {
                        currentStep = 3;
                        updateProgressIndicator();
                        showSection("structure-section");
                    });

                // Final section buttons
                document
                    .getElementById("restart-btn")
                    .addEventListener("click", restart);
                document
                    .getElementById("export-btn")
                    .addEventListener("click", exportPlan);
            });
        </script>
    </body>
</html>
